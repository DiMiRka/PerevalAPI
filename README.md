# PerevalAPI  

–°–µ—Ä–≤–∏—Å –¥–ª—è —É—á–µ—Ç–∞ –≥–æ—Ä–Ω—ã—Ö –ø–µ—Ä–µ–≤–∞–ª–æ–≤ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é CRUD-–æ–ø–µ—Ä–∞—Ü–∏–π, —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø–µ—Ä–µ–≤–∞–ª–∞—Ö, –∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –∏ —É—Ä–æ–≤–Ω–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è –≥–æ–¥–∞.  

## üìå –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–µ—Ä–µ–≤–∞–ª–æ–≤ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ (`POST /pass/pass_post`)
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–µ—Ä–µ–≤–∞–ª–µ –ø–æ ID (`GET /pass/pass_get/`)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–≤–∞–ª–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ "new") (`PATCH /pass/pass_patch/`)
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–µ—Ä–µ–≤–∞–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email (`GET /pass/pass_get_email/`)

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Backend**: Python 3.11, FastAPI (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL, SQLAlchemy 2.0 (async)
- **–ú–∏–≥—Ä–∞—Ü–∏–∏**: Alembic
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: Pydantic v2
- **–î–µ–ø–ª–æ–π**: Docker, Docker Compose
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: Pytest

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
PerevalAPI/
‚îú‚îÄ‚îÄalembic/                    # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ versions/              # –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ env.py                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îÇ   ‚îî‚îÄ‚îÄ script.py.mako         # –®–∞–±–ª–æ–Ω –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ
‚îú‚îÄ‚îÄ src/                       # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ api/                   # API —ç–Ω–¥–æ–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ v1/                # –í–µ—Ä—Å–∏—è API
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ pass_point.py  # –≠–Ω–¥–æ–ø–æ–∏–Ω—Ç—ã –ø–µ—Ä–µ–≤–∞–ª–∞
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ user.py        # –≠–Ω–¥–æ–ø–æ–∏–Ω—Ç—ã —é–∑–µ—Ä–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ core/		       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init.py__
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py	       # –ö–æ–Ω—Ñ–∏–≥—É—Ä—Ü–∞–∏–∏ —Å–µ—Ä–≤–∏—Å–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ db_config.py       # –ö–æ–Ω—Ñ–∏–≥—É—Ä—Ü–∞–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ models/		       # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö Sqlalchemy
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init.py__
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py	       # –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pass_point.py      # –ú–æ–¥–µ–ª–∏ –ø–µ—Ä–µ–≤–∞–ª–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.py	       # –ú–æ–¥–µ–ª—å —é–∑–µ—Ä–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ schemas/	       # –°—Ö–µ–º—ã Pydantic
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init.py__
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pass_points.py     # –°—Ö–µ–º—ã –ø–µ—Ä–≤–∞–ª–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.py	       # –°—Ö–µ–º—ã —é–∑–µ—Ä–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/	       # –ë–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init.py__
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pass_points.py     # –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–≤–∞–ª–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ users.py	       # –õ–æ–≥–∏–∫–∞ —é–∑–µ—Ä–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ main.py 	       # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ
‚îú‚îÄ‚îÄ tests/		       # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Pytest 
‚îÇ   ‚îú‚îÄ‚îÄ __init.py__
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py	       # –§–∏–∫—Å—Ç—É—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ test_db.py	       # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ
‚îú‚îÄ‚îÄ .dockerignor               # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã Dcker
‚îú‚îÄ‚îÄ .env                       # –§–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .env.docker                # –§–∞–π–ª docker –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore                 # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã Git
‚îú‚îÄ‚îÄ alembic.ini                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îú‚îÄ‚îÄ docker-compose.yml         # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile                 # –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ FastApi
‚îú‚îÄ‚îÄ pytest.ini		       # –ö–æ–Ω—Ñ–∏–≥—É–ø–∞—Ü–∏—è Pytest
‚îî‚îÄ‚îÄ requirements.txt           # –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   ```bash
   git clone https://github.com/DiMiRka/PerevalAPI.git
   cd PerevalAPI
   ```
2. –°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
    ```bash
    python -m venv venv
    source venv/bin/activate  # –¥–ª—è Linux/MacOS
    venv\Scripts\activate     # –¥–ª—è Windows
   ```
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
    ```bash
    pip install -r requirements.txt
   ```
4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ alembic:
   ```bash
   alembic stamp head
   alembic revision --autogenerate -m "fix_models"
   alembic upgrade head
   ```
5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
    ```bash
    python src/main.py
   ```
### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker
   ```bash
   docker-compose up --build -d
   ```
#### –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- üê≥ –°–æ–∑–¥–∞—Å—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- üîÑ –ü—Ä–∏–º–µ–Ω–∏—Ç –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
- üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç FastAPI —Å–µ—Ä–≤–µ—Ä —Å –∞–≤—Ç–æ—Ä–µ–ª–æ–∞–¥–æ–º

## ‚öô –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
### 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (.env)
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–µ–∑ Docker:
```ini
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=dima-784512
POSTGRES_DB=Pereval

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
HOST=localhost
PORT=8000
DOCKER_MODE=0
```
### 2. Docker –æ–∫—Ä—É–∂–µ–Ω–∏–µ (.env.docker)
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ Docker Compose:
```ini
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ PostgreSQL
POSTGRES_HOST=db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_PORT=5432
POSTGRES_DB=Pereval

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
HOST=0.0.0.0
PORT=8000
RELOAD=true
DOCKER_MODE=1
```
## üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω—ã –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:\
**Swagger UI** (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ): `http://localhost:8000/api/openapi`

### –≠–Ω–¥–æ–ø–æ–∏–Ω—Ç—ã:
- POST /pass/pass_post:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–µ—Ä–µ–≤–∞–ª–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
  - **–ü—Ä–∏–º–µ—Ä —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json**
     ```json
     {
         "beauty_title": "string",
         "title": "string",
         "other_titles": "string",
         "connect": "string",
         "add_time": "2025-05-16T11:41:32.165Z",
         "user": {
            "email": "user@example.com",
            "fam": "string",
            "name": "string",
            "otc": "string",
            "phone": "string"
         },
         "coords": {
            "latitude": 0,
            "longitude": 0,
            "height": 0
         },
         "level": {
            "winter": "string",
            "summer": "string",
            "autumn": "string",
            "spring": "string"
         },
         "images": [
            {
               "data": "string",
               "title": "string"
            }
         ]
     }
     ```
  - **–û—Ç–≤–µ—Ç**: –ï—Å–ª–∏ –ø–µ—Ä–µ–≤–∞–ª —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω:
    ```
    "status": 200, 
    "message": "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ",
    "id": id —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–∞–ª–∞"
    ```
- GET /pass/pass_get:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –ø–µ—Ä–µ–≤–∞–ª—É 
  - **–ü–µ—Ä–µ–¥–∞—ë–º:** id –ø–µ—Ä–µ–≤–∞–ª–∞ –≤ –∑–∞–ø—Ä–æ—Å
  - **–û—Ç–≤–µ—Ç**: json —Ç–µ–ª–æ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ –ø–µ—Ä–µ–≤–∞–ª—É 
- PATCH /pass/pass_patch:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–µ—Ä–µ–≤–∞–ª–∞ –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ "new" 
  - **–ü–µ—Ä–µ–¥–∞—ë–º:** id –ø–µ—Ä–µ–≤–∞–ª–∞ –≤ –∑–∞–ø—Ä–æ—Å + json –ø–µ—Ä–µ–≤–∞–ª–∞, –∏—Å–∫–ª—é—á–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ user
  - **–ü—Ä–∏–º–µ—Ä —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ json**
    ```json
     {
         "beauty_title": "string",
         "title": "string",
         "other_titles": "string",
         "connect": "string",
         "add_time": "2025-05-16T11:41:32.165Z",
         "coords": {
            "latitude": 0,
            "longitude": 0,
            "height": 0
         },
         "level": {
            "winter": "string",
            "summer": "string",
            "autumn": "string",
            "spring": "string"
         },
         "images": [
            {
               "data": "string",
               "title": "string"
            }
         ]
     }
     ```
  - **–û—Ç–≤–µ—Ç**: –ï—Å–ª–∏ –ø–µ—Ä–µ–≤–∞–ª —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω:
    ```
    "state": 1, 
    "message": "–£—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω"
    ```
- GET /pass/pass_get_email:
  - **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–µ—Ä–µ–≤–∞–ª–æ–≤, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º  
  - **–ü–µ—Ä–µ–¥–∞—ë–º:** email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—Å—è
  - **–û—Ç–≤–µ—Ç:** –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–µ—Ä–µ–≤–∞–ª–æ–≤, —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ json
